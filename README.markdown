ManticoraGoogleFederatedLoginBundle 
=========

[![Build Status](https://travis-ci.org/mgiustiniani/ManticoraGoogleFederatedLoginBundle.png?branch=master)](https://travis-ci.org/mgiustiniani/ManticoraGoogleFederatedLoginBundle)
[![Latest Stable Version](https://poser.pugx.org/manticora/google-federated-login-bundle/v/stable.png)](https://packagist.org/packages/manticora/google-federated-login-bundle)
[![Latest Unstable Version](https://poser.pugx.org/manticora/google-federated-login-bundle/v/unstable.png)](https://packagist.org/packages/manticora/google-federated-login-bundle)
[![Total Downloads](https://poser.pugx.org/manticora/google-federated-login-bundle/downloads.png)](https://packagist.org/packages/manticora/google-federated-login-bundle)

[![knpbundles.com](http://knpbundles.com/mgiustiniani/ManticoraGoogleFederatedLoginBundle/badge-short)](http://knpbundles.com/mgiustiniani/ManticoraGoogleFederatedLoginBundle)


this bundle add a relay party Implementation of FpOpenIdBundle for Google App Federated login

## Usage

...

## Installation

### Download Packages

Add the following lines in your `composer.json` file:

```json
{
    "require": {
        "manticora/google-federated-login-bundle": "dev-master"
    }
}
```


Now, run composer.phar to download the bundle:

```bash
$ php composer.phar install
```

**Note:** You can immediately start using it. The autoloading files have been generated by composer and already included to the app autoload file.

### Step 2: Enable the bundle

Finally, enable the bundle in the kernel:

``` php
<?php
// app/AppKernel.php

public function registerBundles()
{
    $bundles = array(
        // ...
        new Manticora\GoogleFederatedLoginBundle\ManticoraGoogleFederatedLoginBundle(),
        new Fp\OpenIdBundle\FpOpenIdBundle(),
    );
}
```
### Step 3: Configure app/config/config.yml
``` yaml

manticora_google_federated_login:
    domain: example.com
```
### Step4: Configure FpOpenId
 Follow other instructions [FpOpenIdBundle](https://github.com/formapro/FpOpenIdBundle)

### Step5: Configure OpenId for your domain
 Follow [How to Setup OpenID with Google Apps](http://jeremiahlee.com/blog/2009/09/28/how-to-setup-openid-with-google-apps/)

### Step6: Add RelayParty in FpOpenId security.yml config
add relying_party:
```yaml
security:
  ...
  firewalls:
        ...
        secured_area:
            pattern:    ^/admin #example path
            fp_openid:
                ...
                relying_party:                manticora_google_federated_login.relay_party
```

add required_attributes:
```yaml
security:
  ...
  firewalls:
        ...
        secured_area:
            pattern:    ^/admin #example path
            fp_openid:
                ...
                required_attributes:
                    [ contact/email, namePerson/first, namePerson/last, namePerson ]
```
see example
```yaml
security:
  ...
  firewalls:
        ...
        secured_area:
            pattern:     ^/admin #example path
            fp_openid:
                create_user_if_not_exists: true # so createUserFromIdentity method will be called
                provider: openid_user_manager # cf below
                login_path:                   /admin/login_openid
                check_path:                   /admin/login_check_openid
                relying_party:                manticora_google_federated_login.relay_party
                required_attributes:
                    [ contact/email, namePerson/first, namePerson/last, namePerson ]
```



## License

ManticoraGoogleFederatedLoginBundle is released under the MIT License. See the bundled LICENSE file for
details.
